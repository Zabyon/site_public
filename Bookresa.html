<li><a href="HomePage.html">L'association</a></li>
				<li><a href="Adhesion.html">Adhérez !</a></li><!doctype html>
<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>Azurealpes® Games Booking</title>
    <link rel="stylesheet" href="styles/Fixed_banner.css"/>
  <style>

 body {
  margin: 0;
  padding-top :62px; /* Ajoute l'écrat pour que la bannière apparaisse et n'écrase pas le contenu */
  background-color: #ddd
 }



 /* FIN Menu GAUCHE */
        button {
            background-color: #4CAF50; 
            color: white; /* Texte */
            padding: 15px 30px; /* Espacement intérieur */
            border: none; /* Pas de bordure */
            border-radius: 30px; /* Bords arrondis */
            cursor: crosshair; /* Curseur de la main au survol */
            font-size: 18px; /* Taille du texte */
        }

        button:hover {
            background-color: #45a049; /* Légèrement plus foncé au survol */
        }
    
        input {
          width: 100%;
          height: 30px;
        }

         #result1 {
            margin-top: 20px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            min-height: 50px;
        }

         #result2 {
            margin-top: 20px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            min-height: 50px;
             width: 50%;
        }

    /*/ container */
        .containerMid {
          display: flex;
          flex-wrap: wrap;
          gap: 10px;
          border: 2px dashed #ddd;
          padding: 10px;
          
        }

        .item {
            flex: 1 1 600px; /* 1: peut grandir, 1: peut rétrécir, 600px: largeur de base */
            border: 1px solid blue;
            padding: 10px;
            box-sizing: border-box; /* Inclut le padding et la bordure dans la largeur/hauteur */
        }

        /* Styles spécifiques pour le premier élément (optionnel) */
        .item:first-child {
            border-color: green;
        }

        /* Styles spécifiques pour le deuxième élément (optionnel) */
        .item:last-child {
            border-color: pink;
        }
   
         .item2 {
            flex: 1 1 200px; /* 1: peut grandir, 1: peut rétrécir, 600px: largeur de base */
            border: 1px solid blue;
            padding: 0px;
            /*Inclut le padding et la bordure dans la largeur/hauteur */
        }

        /* LE DROPDOWN MENU*/
      h4 {
    color: #333;
    margin-bottom: 30px;
}

/* Basic styling for the label */
label {
    display: block;
    margin-bottom: 8px;
    font-weight: bold;
    color: #555;
}


.custom-dropdown {
    width: 200px; /* Set a fixed width */
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
    background-color: #fff;
    font-size: 16px;
    color: #333;
    appearance: none; /* Removes default browser styling for select */
    -webkit-appearance: none; /* For Safari */
    -moz-appearance: none; /* For Firefox */
    cursor: pointer;
    outline: none; /* Remove outline on focus */
    box-shadow: 0 2px 5px rgba(0,0,0,0.1); /* Subtle shadow */
}

.custom-dropdown {
    background-image: url('data:image/svg+xml;utf8,<svg fill="#666666" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/><path d="M0 0h24v24H0z" fill="none"/></svg>');
    background-repeat: no-repeat;
    background-position: right 10px center;
    background-size: 20px;
    padding-right: 30px; /* Make space for the custom arrow */
}

.custom-dropdown:hover {
    border-color: #999;
}

/* Styling for when the dropdown is focused (clicked/tabbed to) */
.custom-dropdown:focus {
    border-color: #007bff; /* Highlight border on focus */
    box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.25); /* Glow effect */
}

.custom-dropdown option {
    padding: 10px;
    background-color: #fff;
    color: #333;
}

/* You can also style the options when they are hovered in some browsers */
.custom-dropdown option:hover {
    background-color: #f0f0f0;
}
/*fin dropdown*/
.mainimg {
  /* 1. Définir la largeur à 80% du conteneur */
  width: 70%;
  /* 2. Convertir en élément de bloc pour le centrage horizontal par marge */
  display: block;
  /* 3. Centrer horizontalement l'image dans son conteneur */
  margin-left: auto;
  margin-right: auto;
}
    

.text-container {
  width: 70%;
  margin: 0px auto 0 auto; /* Ajouter une marge supérieure de 20px et centrer */
}
/* A RETIRER ENSUITE MAIS ATTENTION A TOUTES LES URLS CAR TOUT POUR LE DEV !*/

#Saisie_Jeu {
  border-radius: 40px; /* Ajustez cette valeur si nécessaire */

  /* (Optionnel) Ajoute un léger rembourrage pour l'esthétique */
  padding: 8px 10px;
}

#Saisie_Jeu::placeholder {
  /* Police en italique */
  font-style: italic;
  color: #aaa;
}
	  
</style>

</head>
<body>
 <div class="fixed-banner">
    <img src="https://cdn.leonardo.ai/users/65caef68-b2fc-4b3c-aea2-9b83729fe324/generations/00d49c31-cda1-4d82-a3ff-633dbea000ae/variations/Default_Generate_a_vibrant_highresolution_3D_Logo_that_remind_0_00d49c31-cda1-4d82-a3ff-633dbea000ae_0.png" alt="Mon image de test" class="logo" />
    <h1>Azurealpes ®</h1>
    <button id="menu-toggle-button" aria-expanded="false" aria-controls="fixed-sidebar">
        ☰ </button>
 </div>

  <div class="main-layout">
    <div class="fixed-sidebar">
        <nav>
            <ul>
				<li><a href="HomePage.html">L'association</a></li>
				<li><a href="Adhesion.html">Adhérez !</a></li>
                <li><a href="ApiProd.html">Main Menu</a></li>
				<li><a href="NousContacter.html">Notre équipe et contact</a></li>
                <li><a href="ProfilePage.html">Profile</a></li>
            </ul>
            <hr>
            <ul>
                <li><a href="Mentions_Légales.html">Mentions Légales</a></li>
                <li><a href="Bookresa.html">Créer Réservation</a></li>
		    	<li><a href="#">Réservation En Cours</a></li>
            </ul>      
        </nav>
      </div>  
  
      <div class="main-content">   
        <div class="containerMid"> 
        <img src="https://cdn.leonardo.ai/users/65caef68-b2fc-4b3c-aea2-9b83729fe324/generations/1f0a86b9-e03e-6db0-b652-32a9be5bc86b/gemini-2.5-flash-image-preview_Add_some_dragon_and_knight_action_figure_lying_on_the_table-0.jpg" alt="image ppale decrivant AFINIR" class="mainimg" />   
        </div>   
  
        <div class="containerMid">
          <div class="text-container">
           <p>
            Ceci est la première ligne de texte. Le conteneur a une largeur de 70% de son parent et est centré.
            </p>
            <p>
            Peu importe le nombre de lignes que vous ajoutez, le conteneur s'adaptera. Cette deuxième ligne montre que le texte s'écoule naturellement à l'intérieur de la boîte de 80% de largeur.
            </p>
            <ul>
            <li>Liste à puce 1</li>
            <li>Liste à puce 2</li>
            </ul>
            <p>
            Le conteneur de texte sera toujours aligné avec l'image au-dessus, créant une présentation propre et professionnelle.
            </p>
         </div> 
          
       <div class="containerMid">          
         <h2> Creation table de jeu </h2>
         <button id ="Bouton2" >Réserver !</button>
         <div id="result2">Résultat de l'API2 apparaîtra ici.</div>
       </div>
             
    <hr>  
    <h2> A la decouverte d'un nouveau jeu </h2>
    <button id ="RESET" onclick="resetData('result2','ecranJeu')">Discover</button>
    
    <hr>
    
    <div class="containerMid">
       <input type="string" name="Jeu" id="Saisie_Jeu" placeholder="Styles de jeu, Temps de jeu, Coop ..."/>
       <div id="result3">Résultat du champ apparaîtra ici!!!!.</div>
    </div>  
    <hr>
   
</div> 
      </div>      
 <script>

const jwtToken = sessionStorage.getItem('jwtToken');
//fonctions
async function recupData2(urlJeu,jeuCall="/listerTout",yesOrno="none") {
            const data = {              
                    Jeu: jeuCall,
                    Emprunt: yesOrno,
                    code: 1               
            };
            try {
                const response = await fetch(urlJeu, {
                    method: 'POST',
                    headers: {
			'Authorization': 'Bearer ' + jwtToken, 
                        'Content-Type': 'application/json'
                        //TODO ajouter securite header et token
                    },
                    body: JSON.stringify(data)
                });

                if (!response.ok) {
                    throw new Error(`Erreur HTTP: ${response.status}`);
                    return 'errooor';
                }

                const responseData = await response.json(); 
console.log("AVANT");  
console.log("Mes données avant traitement :", responseData);                
console.log("APRES");                 
                return responseData
            } catch (error) {
                console.error('Erreur lors de la récupération des données:', error);
                return 'Erreur lors de la récupération des données fct recupData2.';
            }
        }

 async function resetData(affich1,affich2) {
            document.getElementById(affich1).innerText = 'Reset';
            document.getElementById(affich2).innerText = 'Reset';
         //   const test = await recupData2('http://172.16.254.30:5678/webhook/5a5e1bde-ac93-4a94-838f-9aa7ee57e519');
        //    document.getElementById(affich2).innerText = test[0].Jeu[3];
        }
 
function displayData(selectorCSS, data) {
            const element = document.querySelector(selectorCSS);
            if (element) {
                element.textContent = JSON.stringify(data, null, 2);
            
            } else {
                console.error(`Erreur: L'élément avec le sélecteur "${selectorCSS}" est introuvable.`);
            }
        }
 
 
class BoutonAction {
    constructor(boutonID,divAssociee,apiUrl,listederoulante = 'undefined',emprunt = 'none'){
     this.bouton = document.getElementById(boutonID);
     this.boutonDiv = divAssociee;
     this.apiUrl = apiUrl;
     this.listeDeroulante = document.getElementById(listederoulante);
     this.isEmprunte = emprunt;
     this.init();     
    }
 
    init() {
        if (this.bouton) {
            this.bouton.addEventListener('click', this.handleClick.bind(this));
        } else {
            console.error(`Le bouton avec l'ID '${boutonID}' est introuvable.`);
        }
    }
 
    async handleClick() {
        try {                                               
           if (this.listeDeroulante === null ) { // Utilisation de '===' pour une comparaison stricte
               const data = await recupData2(this.apiUrl,'/listerTout',this.isEmprunte);
               displayData(this.boutonDiv, data);
           }else{  
               	const data = await recupData2(this.apiUrl,this.listeDeroulante.value,this.isEmprunte);
               displayData(this.boutonDiv, data);
           	
           }      	
        } catch (error) {
           displayData(boutonDiv, { error: `Impossible de charger les données: ${error.message}` });
      }
    }    
}
//class butoon
     
const listerToutBouton = new BoutonAction('Bouton2','#result2','http://172.16.254.30:5678/webhook/5a5e1bde-ac93-4a94-838f-9aa7ee57e519');          
const infoBouton = new BoutonAction('infoButton','#ecranJeu','http://172.16.254.30:5678/webhook/5a5e1bde-ac93-4a94-838f-9aa7ee57e519','myDropdown');          
const empruntBouton = new BoutonAction('empruntButton','#ecranJeu','http://172.16.254.30:5678/webhook/5a5e1bde-ac93-4a94-838f-9aa7ee57e519','myDropdown','yes');          
const rendBouton = new BoutonAction('rendButton','#ecranJeu','http://172.16.254.30:5678/webhook/5a5e1bde-ac93-4a94-838f-9aa7ee57e519','myDropdown','no');          

//peuplerListeDeroulante();
 
 //logique de gestion des events hors bouton
document.addEventListener('DOMContentLoaded', () => {
    const myButton = document.getElementById('myButt');
    const targetDiv = '#result1';
    const apiUrl = 'http://172.16.254.30:5678/webhook/5a5e1bde-ac93-4a94-838f-9aa7ee57e519';
    
    if (myButton) {//bouton qui recup la saisie ligne
        myButton.addEventListener('click', async () => {
            try {                                               
                const champJeu2 = document.getElementById('Saisie_Jeu').value.toString(); //gerer le caz vide
                const data = await recupData2(apiUrl,champJeu2);
                displayData(targetDiv, data);
                } catch (error) {
                displayData(targetDiv, { error: `Impossible de charger les données: ${error.message}` });
                }
        });
    } else {
        console.error("Le bouton avec l'ID 'myButt' est introuvable.");
        displayData(targetDiv, { error: `Impossible probleme button}` });
    }            
 
 //je dois ?? creer une requete GET pr lister tout et pas POST 
 //car un Get doit avoir seulement donnee dans l'URL
	
	peuplerListeDeroulante();
  })
 
  //teste dorpdown
const maListeDeJeuxSimples = ["Flowers", "Dekal", "Pixies", "Explorers", "Guardians", "Legends"];


async function peuplerListeDeroulante() {
	const listeDeroulante = document.getElementById('myDropdown');
   	try {                                               
        	const test = await recupData2('http://172.16.254.30:5678/webhook/5a5e1bde-ac93-4a94-838f-9aa7ee57e519');
		const jeux =test[0].Jeu;

		if (!Array.isArray(jeux) || jeux.length === 0) {
            		console.warn("Le tableau de jeux est vide ou mal formaté.");
            		// Gérer ce cas (par exemple, afficher un message à l'utilisateur)
            		return; // Sortir de la fonction si pas de jeux
        		}
  		const test2 = test[0].Jeu[3];
  		console.log(test2);

		listeDeroulante.innerHTML = '';
		jeux.forEach(jeu => {
            		const option = document.createElement('option'); // Crée un nouvel élément <option>
            			option.value = jeu; // La valeur de l'option (ce qui sera envoyé si le formulaire est soumis)
            			option.textContent = jeu; // Le texte visible dans la liste déroulante
            			listeDeroulante.appendChild(option); // Ajoute l'option au <select>
        		})
		const defaultOption = document.createElement('option');
        	defaultOption.value = "";
        	defaultOption.textContent = "Sélectionner un jeu...";
        	defaultOption.selected = true; // Pour la sélectionner par défaut
        	defaultOption.disabled = true; // Pour qu'elle ne soit pas sélectionnable après le choix initial
        	listeDeroulante.prepend(defaultOption);
                } catch (error) {
                console.log("aaaaaaa(€(€)39€_!4)€8aaaaaaaaaaaaaa");
        }
}

    
    </script>

<script src=./scripts/JS_sitee.js> </script>

</body>
</html>
